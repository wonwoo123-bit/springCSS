<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Pds-Mapper">
    <sql id="search">
        <if test="searchType == 't'.toString()"> and title like '%'||#{keyword}||'%' </if>
		<if
            test="searchType == 'w'.toString()"> and writer like '%'||#{keyword}||'%' </if>
		<if
            test="searchType == 'c'.toString()"> and content like '%'||#{keyword}||'%' </if>
		<if
            test="searchType == 'tc'.toString()"> and ( title like '%'||#{keyword}||'%' or content
        like '%'||#{keyword}||'%' ) </if>
		<if test="searchType == 'cw'.toString()"> and ( writer like
        '%'||#{keyword}||'%' or content like '%'||#{keyword}||'%' ) </if>
		<if
            test="searchType == 'tcw'.toString()"> and ( title like '%'||#{keyword}||'%' or writer
        like '%'||#{keyword}||'%' or content like '%'||#{keyword}||'%' ) </if>
    </sql>
    <select id="selectSearchPdsList" resultType="pds"> select * from( select rownum as
        rnum,SearchPdsResult.* from ( select * from pds where pno is not null <include
            refid="search" /> order by regDate desc ) SearchPdsResult <![CDATA[
		    where rownum <= #{endRow}		    
		)		 
		where rnum > #{startRow}		
		 ]]>
	</select>

    <select id="selectSearchPdsListCount" resultType="int"> select count(*) from pds where pno
        is not null <include refid="search" /> order by regDate desc </select>
        
    <select id="selectPdsByBno" parameterType="int" resultType="pds"> select * from pds
        where pno=#{pno} </select>

    <select id="selectPdsSeqNext" resultType="int"> select pds_seq.nextVal from dual </select>

    <update id="increaseViewCount" parameterType="int"> update pds set viewcnt=viewcnt+1 where
        pno=#{pno} </update>

    <update id="insertPds" parameterType="pds"> insert into pds(pno,title,writer,content)
        values(#{pno},#{title},#{writer},#{content}) </update>


    <update id="updatePds" parameterType="pds"> update pds set
        title=#{title},content=#{content} where pno=#{pno} </update>

    <update id="deletePds" parameterType="int"> delete from pds where pno=#{pno} </update>
</mapper>